!function(){var a={};a.init=function(b){if("undefined"==typeof b)throw new Error("Please specify Arel session parameters.");if(void 0===b.canvas)throw new Error("Arel needs a <canvas> element to render to.");return a.display.__init.call(a.display,this,b),a},window.arel=a}(),function(){function a(a){if(1==arguments.length){if(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a))return b(a);if("undefined"!=typeof e[a])return b(e[a])}throw new Error("Invalid color supplied!")}function b(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);if(!d)throw new Error("Invalid color supplied!");return c(parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16))}function c(a,b,c,e){return new d(a,b,c,e)}function d(a,b,c,d){this.r=a||0,this.g=b||0,this.b=c||0,this.a=d||1}var e={white:"FFFFFF",silver:"C0C0C0",gray:"808080",black:"000000",red:"FF0000",maroon:"800000",yellow:"FFFF00",olive:"808000",lime:"00FF00",green:"008000",aqua:"00FFFF",teal:"008080",blue:"0000FF",navy:"000080",fuschia:"FF00FF",purple:"800080"};d.prototype.toString=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a+")"},arel.color=a}(),function(){var a={};a.__init=function(a,b){if(void 0===b.canvas.getContext)throw new Error("Arel needs a <canvas> element to render to.");this.canvas=b.canvas,this.context=b.canvas.getContext("2d"),this.context.textBaseline="alphabetic",this.context.textAlign="left",this.font=b.font||"Courier",this.fontSize=b.fontSize||12;var c=document.createElement("div");c.innerHTML="M",c.style.position="absolute",c.style.top="-100px",c.style.left="-100px",c.style.fontFamily=this.font,c.style.fontSize=this.fontSize+"pt",document.body.appendChild(c),this.context.font=this.fontSize+"pt "+this.font,this.context.textBaseline="middle",this.context.textAlign="center",this.padding=b.padding||1,this.cellWidth=this.context.measureText("W").width+2*this.padding,this.cellOffsetWidth=Math.round(this.cellWidth/2),this.cellHeight=c.offsetHeight+2*this.padding+2*this.padding,this.cellOffsetHeight=Math.round(this.cellHeight/2),document.body.removeChild(c),this.width=b.width||10,this.height=b.height||10,this.batchingEnabled="undefined"==typeof b.batchingEnabled?!0:b.batchingEnabled,this.canvas.width=this.width*this.cellWidth,this.canvas.height=this.height*this.cellHeight,this.context.font=this.fontSize+"pt "+this.font,this.context.textBaseline="middle",this.context.textAlign="center",this._foregroundBatches={},this._backgroundBatches={}},a.draw=function(b){if(void 0===b.character||b.character instanceof Array||(b.character=[b.character]),a.batchingEnabled){var c=(b.color||arel.color("white")).toString(),d=(b.backgroundColor||arel.color("black")).toString();"undefined"!=typeof b.character&&" "!==b.character&&("undefined"!=typeof a._foregroundBatches[c]?a._foregroundBatches[c].push(b):a._foregroundBatches[c]=[b]),"undefined"!=typeof a._backgroundBatches[d]?a._backgroundBatches[d].push(b):a._backgroundBatches[d]=[b],void 0===a._renderTimeout&&(a._renderTimeout=setTimeout(function(){a._drawBackground(),a._drawForeground(),a._foregroundBatches=void 0,a._backgroundBatches=void 0,a._renderTimeout=void 0},.06))}else a._draw(b);return a},a._draw=function(b){var c=b.x*a.cellWidth,d=b.y*a.cellHeight,e=b.character||" ",f=b.color||arel.color("white"),g=b.backgroundColor||arel.color("black");a.context.fillStyle=g.toString(),a.context.fillRect(c,d,a.cellWidth,a.cellHeight);for(var h=0,i=e.length;i>h;h++)a.context.fillStyle=f.toString(),a.context.fillText(e[h],c+a.cellOffsetWidth,d+a.cellOffsetHeight)},a._drawForeground=function(){var b,c,d,e,f=a._foregroundBatches;for(c in f)for(b=f[c],a.context.fillStyle=c,d=0;d<b.length;d++)for(e=0;e<b[d].character.length;e++)a.context.fillText(b[d].character[e],b[d].x*a.cellWidth+a.cellOffsetWidth,b[d].y*a.cellHeight+a.cellOffsetHeight)},a._drawBackground=function(){var b,c,d,e=a._backgroundBatches;for(c in e)for(b=e[c],a.context.fillStyle=c,d=0;d<b.length;d++)a.context.fillRect(b[d].x*a.cellWidth,b[d].y*a.cellHeight,a.cellWidth,a.cellHeight)},window.arel.display=a}(),function(){var a={};a.__init=function(){},window.arel.input=a}();